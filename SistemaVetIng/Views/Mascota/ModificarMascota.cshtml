@model SistemaVetIng.ViewsModels.MascotaEditarViewModel

@{
    ViewData["Title"] = "Modificar Mascota";
    Layout = null;

    // Obtiene el controlador de destino según el rol del usuario
    string controllerDestino = "";
    if (User.IsInRole("Veterinario"))
    {
        controllerDestino = "Veterinario";
    }
    else
    {
        controllerDestino = "Veterinaria";
    };
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modificar Mascota</title>

    <link rel="stylesheet" href="~/css/veterinario-home.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <header class="main-header">
        <a href="#" class="logo">
            <i class="fas fa-paw"></i>
            <span>VetIng</span>
        </a>
        <a asp-controller="@controllerDestino" asp-action="PaginaPrincipal" class="btn sesion">
            <i class="fas fa-arrow-left"></i> Volver al Inicio
        </a>
    </header>

    <main class="registrar-form-main">
        <section class="form-section">
            <h2 class="section-title">Modificar Mascota</h2>
            <p class="form-subtitle">Editando datos de la mascota del Cliente: <strong>@ViewBag.ClienteNombre</strong></p>

            <form asp-controller="Mascota" asp-action="ModificarMascota" method="post" class="main-form">
                @Html.AntiForgeryToken()

                <input type="hidden" asp-for="Id" />
                <input type="hidden" asp-for="ClienteId" />

                <div class="form-group">
                    <label asp-for="Nombre"></label>
                    <input asp-for="Nombre" class="form-control" placeholder="Nombre de la mascota" />
                    <span asp-validation-for="Nombre" class="text-danger validation-error"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Especie"></label>
                    <select asp-for="Especie" class="form-control" id="especieMascota">
                        <option value="">Seleccione la especie</option>
                        <option value="Perro">Perro</option>
                        <option value="Gato">Gato</option>
                        <option value="Pájaro">Pájaro</option>
                        <option value="Roedor">Roedor</option>
                        <option value="Reptil">Reptil</option>
                        <option value="Otro">Otro</option>
                    </select>
                    <span asp-validation-for="Especie" class="text-danger validation-error"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Raza"></label>
                    <input asp-for="Raza" class="form-control" id="razaMascota" placeholder="Ej: Labrador, Siames, Pitbull" />
                    <span asp-validation-for="Raza" class="text-danger validation-error"></span>
                </div>

                <div class="form-group">
                    <label asp-for="FechaNacimiento"></label>
                    <input asp-for="FechaNacimiento" class="form-control" type="date" />
                    <span asp-validation-for="FechaNacimiento" class="text-danger validation-error"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Sexo"></label>
                    <select asp-for="Sexo" class="form-control">
                        <option value="">Seleccione el sexo</option>
                        <option value="Macho">Macho</option>
                        <option value="Hembra">Hembra</option>
                        <option value="Desconocido">Desconocido</option>
                    </select>
                    <span asp-validation-for="Sexo" class="text-danger validation-error"></span>
                </div>

                <input type="hidden" asp-for="RazaPeligrosa" id="esRazaPeligrosa" />

                <div class="form-group" id="chipGroup" style="display: none;">
                    <label asp-for="Chip"></label>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="tieneChip" asp-for="Chip">
                        <label class="form-check-label" for="tieneChip">Sí, posee chip</label>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="button register-button">Guardar Cambios</button>
                    <a asp-controller="Mascota" asp-action="ListarClientes" asp-route-clienteId="@Model.ClienteId" class="btnBack">Cancelar</a>
 
                </div>
            </form>
        </section>
    </main>

    <footer class="main-footer">
        <div class="footer-col footer-info">
            <div class="footer-logo-container"> <i class="fa-solid fa-paw footer-logo-icon"></i> <h3 class="footer-brand">VetIng Software</h3> </div>
            <p class="footer-description">Soluciones tecnológicas para un cuidado animal excepcional.</p> <div class="footer-social-icons">
                <a href="#"><i class="fa-brands fa-instagram"></i></a>
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-youtube"></i></a>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
            </div>
        </div>
        <div class="footer-col">
            <h4 class="footer-heading">Acerca de VetIng</h4> <ul class="footer-links">
                <li><a href="#">Nuestra Historia</a></li>
                <li><a href="#">Equipo</a></li>
                <li><a href="#">Noticias y Blog</a></li>
                <li><a href="#">Fundación VetIng</a></li>
            </ul>
        </div>
        <div class="footer-col">
            <h4 class="footer-heading">Soporte</h4> <ul class="footer-links">
                <li><a href="#">Preguntas Frecuentes</a></li>
                <li><a href="#">Contacto</a></li>
                <li><a href="#">Guías de Usuario</a></li>
                <li><a href="#">Descargar App Móvil</a></li>
            </ul>
        </div>
        <div class="footer-col">
            <h4 class="footer-heading">Legal</h4>
            <ul class="footer-links">
                <li><a href="#">Términos y Condiciones</a></li>
                <li><a href="#">Política de Privacidad</a></li>
                <li><a href="#">Aviso Legal</a></li>
                <li><a href="#">Cookies</a></li>
            </ul>
        </div>
        <div class="footer-bottom">
            <p>&copy; @DateTime.Now.Year VetIng Software. Todos los derechos reservados. | Proyecto de Ulises Sosa y Leonel Gallaretto</p>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

    <script>
        $(document).ready(function () {
            function checkRazaPeligrosa() {
                var especie = $('#especieMascota').val().toLowerCase();
                var raza = $('#razaMascota').val().toLowerCase().trim();

                var razasPeligrosas = [
                    "pitbull", "rottweiler", "dogo argentino", "fila brasileiro",
                    "akita inu", "tosa inu", "doberman", "staffordshire bull terrier",
                    "american staffordshire terrier", "pastor alemán"
                ];

                var esPerro = (especie === "perro");
                var esPeligrosa = esPerro && razasPeligrosas.includes(raza);

                if (esPeligrosa) {
                    $('#chipGroup').slideDown();
                    $('#esRazaPeligrosa').val('true');
                } else {
                    $('#chipGroup').slideUp();
                    $('#tieneChip').prop('checked', false);
                    $('#esRazaPeligrosa').val('false');
                }
            }

            checkRazaPeligrosa();

            $('#especieMascota, #razaMascota').on('change keyup', function () {
                checkRazaPeligrosa();
            });
        });
    </script>
    @await Component.InvokeAsync("NToastNotify")
</body>
</html>